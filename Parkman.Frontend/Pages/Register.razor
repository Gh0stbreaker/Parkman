@page "/register"
@using System.Net.Http.Json

<h3 class="text-2xl font-bold mb-4 text-center">Register</h3>

<EditForm Model="_model" OnValidSubmit="RegisterUser" class="max-w-lg mx-auto bg-white p-6 rounded shadow">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700">Email</label>
        <InputText @bind-Value="_model.Email" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" />
    </div>
    <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700">Password</label>
        <InputText @bind-Value="_model.Password" type="password" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" />
    </div>
    <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700">First name</label>
        <InputText @bind-Value="_model.FirstName" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" />
    </div>
    <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700">Last name</label>
        <InputText @bind-Value="_model.LastName" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" />
    </div>
    <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700">Date of birth</label>
        <InputDate @bind-Value="_model.DateOfBirth" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" />
    </div>
    <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700">Phone number</label>
        <InputText @bind-Value="_model.PhoneNumber" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" />
    </div>
    <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700">Address</label>
        <InputText @bind-Value="_model.Address" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" />
    </div>
    <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700">License plate</label>
        <InputText @bind-Value="_model.LicensePlate" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" />
    </div>
    <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700">Brand</label>
        <InputText @bind-Value="_model.Brand" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" />
    </div>
    <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700">Type</label>
        <InputText @bind-Value="_model.Type" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" />
    </div>
    <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700">Propulsion type</label>
        <InputText @bind-Value="_model.PropulsionType" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500" />
    </div>
    <div class="flex items-center mb-6">
        <InputCheckbox @bind-Value="_model.Shareable" class="h-4 w-4 text-indigo-600 border-gray-300 rounded" />
        <label class="ml-2 block text-sm text-gray-700">Shareable</label>
    </div>

    <button type="submit" class="w-full bg-indigo-600 text-white py-2 px-4 rounded hover:bg-indigo-700">Register</button>
</EditForm>

@code {
    private RegisterWithVehicleRequest _model = new();

    [Inject] private HttpClient Http { get; set; } = default!;

    private async Task RegisterUser()
    {
        await Http.PostAsJsonAsync("api/Registration", _model);
    }

    public class RegisterWithVehicleRequest
    {
        public string Email { get; set; } = string.Empty;
        public string Password { get; set; } = string.Empty;
        public string FirstName { get; set; } = string.Empty;
        public string LastName { get; set; } = string.Empty;
        public DateOnly? DateOfBirth { get; set; }
        public string PhoneNumber { get; set; } = string.Empty;
        public string Address { get; set; } = string.Empty;
        public string LicensePlate { get; set; } = string.Empty;
        public string Brand { get; set; } = string.Empty;
        public string Type { get; set; } = string.Empty;
        public string PropulsionType { get; set; } = string.Empty;
        public bool Shareable { get; set; }
    }
}
